
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Deploying Octopress to Existing GitHub Pages Repo - Bohumír Zámečník</title>
  <meta name="author" content="Bohumír Zámečník">

  
  <meta name="description" content="Today I&rsquo;ve decided to move my blog from Tumblr to Octopress and merge it with my homepage which is hosted on GitHub Pages. I realized I&rsquo;m &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://zamecnik.me/blog/2014/deploying-octopress-to-existing-github-pages-repo">
  <link href="https://s.gravatar.com/avatar/f90538dcd2df4a510c8f0b057154dea1?s=32" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Bohumír Zámečník" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44857522-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Bohumír Zámečník</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="http://eepurl.com/xX1M1" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:zamecnik.me" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives/">Archives</a></li>
  <li><a href="/projects/">Projects</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Deploying Octopress to Existing GitHub Pages Repo</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-05T22:33:33+01:00" pubdate data-updated="true">Jan 5<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Today I&rsquo;ve decided to move my blog from <a href="http://tumblr.com">Tumblr</a> to <a href="http://octopress.org/">Octopress</a> and merge it with my homepage which is hosted on <a href="http://pages.github.com/">GitHub Pages</a>. I realized I&rsquo;m a unix-based guy and feel more comfortable with plain text files, Git, possibility to work offline and a set of scripts that I have access to than with some cool but untouchable web service. Recent static site generators like Middleman and Git-deployed hosting was like a holy grail sent from heavens. I used then before on other sites (eg. <a href="http://harmoneye.com">harmoneye.com</a>). During a night I managed to set up an Octopress site locally, migrate the content and prepare for deployment. But the actual act of deploying to an existing GitHub Pages repository turned up to be a problem worth several hours of solving. Here&rsquo;s the description of how to do it as I didn&rsquo;t find the solution on the web yet. Hope it helps somebody.</p>

<!--more-->


<p>Octopress deployment to GitHub Pages is nicely described in the <a href="http://octopress.org/docs/deploying/github/">documentation</a>. However, it expects the target repo to be empty. This was not the case.</p>

<h3>The situation</h3>

<ul>
<li>I have an clean local installation of Octopress filled with content, configuration and some little customizations (style changes, some plugins added, etc.).</li>
<li>Also I have an existing GitHub Pages repository (<a href="https://github.com/bzamecnik/zamecnik.me">https://github.com/bzamecnik/zamecnik.me</a>) that contains a single static page generated by Middleman and available at <a href="http://zamecnik.me/">http://zamecnik.me/</a> via CNAME. It is a Project repository, not a User/Organization one. So the sources are in the <code>master</code> branch and the HTML files for publishing in the <code>gh-pages</code> branch.</li>
<li>The deployment rake task <code>rake deploy</code> generates the output files into the <code>_deploy</code> directory, makes a new nested Git repo there and sets its <code>origin</code> remote to the provided GitHub repository URL.</li>
</ul>


<p>I&rsquo;d like to deploy the local Octopress to this existing repository. The manual and the scripts, on the other hand, expect that the repository be empty. When I run <code>rake deploy</code> it tries to pull from the remote repository and it fails on some files that must be merged.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>## Pushing generated _deploy website
</span><span class='line'>To git@github.com:bzamecnik/zamecnik.me.git
</span><span class='line'> ! [rejected]        gh-pages -&gt; gh-pages (non-fast-forward)
</span><span class='line'>error: failed to push some refs to 'git@github.com:bzamecnik/zamecnik.me.git'
</span><span class='line'>hint: Updates were rejected because the tip of your current branch is behind
</span><span class='line'>hint: its remote counterpart. Integrate the remote changes (e.g.
</span><span class='line'>hint: 'git pull ...') before pushing again.
</span><span class='line'>hint: See the 'Note about fast-forwards' in 'git push --help' for details.</span></code></pre></td></tr></table></div></figure>


<p>I didn&rsquo;t want to delete the repository and create a new one, since I wanted a smooth transition.</p>

<h3>The solution that worked for me</h3>

<p>The rough plan was to manually merge both branches <code>master</code> and <code>gh-pages</code> and then let the deploy scripts do their usual work.</p>

<p>I ran the <code>rake setup_github_pages</code>, <code>rake generate</code> and <code>rake deploy</code> commands. And the last one failed that it is not able to pull from the <code>gh-pages</code> branch.</p>

<ul>
<li>So first I commited all my changes in the local Octopress <code>master</code> branch.</li>
<li>Then with a clean staging area I pulled from <code>origin/master</code> to <code>master</code>. This filled the project with some Middleman files that coincidently were also located in the <code>source/</code> directory.</li>
<li>In the Git client I reset and removed all those files to reverted back to the previous state.</li>
<li>Then (being in the merge mode) I commited the merge commit (which had essentially no changes) but joined my local <code>master</code> branch with <code>origin/master</code>.</li>
<li>Then I was able to push it without problems.</li>
</ul>


<p>Then I had to switch to the nested repository located at the <code>_deploy</code> directory. It contained the local <code>gh-pages</code> branch an also <code>origin/gh-pages</code> which was in a different commit tree.</p>

<ul>
<li>I had to manually delete the local <code>gh-pages</code> branch (generated by <code>rake deploy</code>) with <code>git branch -D gh-pages</code>.</li>
<li>Then I checked out the remote <code>origin/gh-pages</code> as a tracking branch with <code>git checkout -t  -b gh-pages origin/gh-pages</code>.</li>
<li>Then I ran <code>rake deploy</code> again and it worked like charm by then since local commits were now just fast-forward compared to those in the origin.</li>
</ul>


<p>And that&rsquo;s it!</p>

<p>Hope that it helps anyone.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Bohumír Zámečník</span></span>

      








  


<time datetime="2014-01-05T22:33:33+01:00" pubdate data-updated="true">Jan 5<span>th</span>, 2014</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://zamecnik.me/blog/2014/deploying-octopress-to-existing-github-pages-repo/" data-via="bzamecnik" data-counturl="http://zamecnik.me/blog/2014/deploying-octopress-to-existing-github-pages-repo/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/week-of-hustle-day-6-and-7/" title="Previous Post: Week of Hustle - Day 6 and 7">&laquo; Week of Hustle - Day 6 and 7</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/harmoneye-for-android-released/" title="Next Post: HarmonEye for Android Released">HarmonEye for Android Released &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
	<h1>About Me</h1>
	<p>How do things work? Ever since 1987 I’ve fallen in love with thinking about it. That’s how I became a <a href="/about/">digital craftsman</a>.</p>
	<p>
	<a href="https://twitter.com/bzamecnik" class="twitter-follow-button" data-show-count="false">Follow @bzamecnik</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
	</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/scandinavia-road-trip-day-16/">Scandinavia Road Trip - Den 16.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/scandinavia-road-trip-day-15/">Scandinavia Road Trip - Den 15.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/scandinavia-road-trip-day-14/">Scandinavia Road Trip - Den 14.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/scandinavia-road-trip-day-13/">Scandinavia Road Trip - Den 13.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/scandinavia-road-trip-day-12/">Scandinavia Road Trip - Den 12.</a>
      </li>
    
  </ul>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/112168593075061741028?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - <a href="/about/">Bohumír Zámečník</a> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




<a href="https://github.com/bzamecnik/zamecnik.me/" class="github-ribbon"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"></a>


</body>
</html>
