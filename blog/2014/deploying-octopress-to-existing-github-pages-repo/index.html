<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Deploying Octopress to existing GitHub Pages repo | Bohumír Zámečník</title>
<link href="../../../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">
<link rel="canonical" href="https://bohumirzamecnik.cz/blog/2014/deploying-octopress-to-existing-github-pages-repo/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Bohumír Zámečník">
<link rel="prev" href="../../2013/week-of-hustle-day-6-and-7/" title="Week of Hustle - Day 6 and 7" type="text/html">
<link rel="next" href="../harmoneye-for-android-released/" title="HarmonEye for Android Released" type="text/html">
<meta property="og:site_name" content="Bohumír Zámečník">
<meta property="og:title" content="Deploying Octopress to existing GitHub Pages repo">
<meta property="og:url" content="https://bohumirzamecnik.cz/blog/2014/deploying-octopress-to-existing-github-pages-repo/">
<meta property="og:description" content="Today I've decided to move my blog from Tumblr to Octopress and merge it with my homepage which is hosted on GitHub Pages. I realized I'm a unix-based guy and feel more comfortable with plain text fil">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2014-01-05T22:33:33+01:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">

        <nav role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../../"><i class="fa fa-2x fa-fw fa-home"></i> Home</a>
          <a class="sidebar-nav-item" href="../../"><i class="fa fa-2x fa-fw fa-user-circle"></i> Blog</a>
        </nav><nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../../about/">About</a>
        <a class="sidebar-nav-item" href="../../../projects/">Projects</a>
        <a class="sidebar-nav-item" href="../../../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../../../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../../../rss.xml">RSS feed</a>
        <a class="sidebar-nav-item" href="https://github.com/bzamecnik/">GitHub</a>
        <a class="sidebar-nav-item" href="https://twitter.com/bzamecnik">Twitter</a>
        <a class="sidebar-nav-item" href="https://www.instagram.com/bzamecnik/">Instagram</a>
        <a class="sidebar-nav-item" href="https://www.flickr.com/photos/elgriton/">Flickr</a>
        <a class="sidebar-nav-item" href="https://www.linkedin.com/in/bohumirzamecnik">LinkedIn</a>
        <a class="sidebar-nav-item" href="mailto:bohumir.zamecnik@gmail.com">E-mail</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h2 id="brand" class="masthead-title">
      <a href="../../../" title="Bohumír Zámečník" rel="home">Bohumír Zámečník</a>
    </h2>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/BlogPosting"><header><h1 class="post-title p-name entry-title" itemprop="headline">
      <a href="https://bohumirzamecnik.cz/blog/2014/deploying-octopress-to-existing-github-pages-repo/" class="u-url">Deploying Octopress to existing GitHub Pages repo</a>
</h1>
        <div class="metadata">
        <meta itemprop="inLanguage" content="en">
<p class="dateline">
            <time class="post-date published dt-published" datetime="2014-01-05T22:33:33+01:00" itemprop="datePublished" title="2014-01-05">2014-01-05</time></p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/2014/deploying-octopress-to-existing-github-pages-repo.html">Comments</a>


        </p>
</div>
        

    </header><section class="e-content entry-content" itemprop="articleBody text"><div>
<p>Today I've decided to move my blog from <a href="http://tumblr.com">Tumblr</a> to <a href="http://octopress.org/">Octopress</a> and merge it with my homepage which is hosted on <a href="http://pages.github.com/">GitHub Pages</a>. I realized I'm a unix-based guy and feel more comfortable with plain text files, Git, possibility to work offline and a set of scripts that I have access to than with some cool but untouchable web service. Recent static site generators like Middleman and Git-deployed hosting was like a holy grail sent from heavens. I used then before on other sites (eg. <a href="http://harmoneye.com">harmoneye.com</a>). During a night I managed to set up an Octopress site locally, migrate the content and prepare for deployment. But the actual act of deploying to an existing GitHub Pages repository turned up to be a problem worth several hours of solving. Here's the description of how to do it as I didn't find the solution on the web yet. Hope it helps somebody.</p>
<!-- TEASER_END -->

<p>Octopress deployment to GitHub Pages is nicely described in the <a href="http://octopress.org/docs/deploying/github/">documentation</a>. However, it expects the target repo to be empty. This was not the case.</p>
<h4>The situation</h4>
<ul>
<li>I have an clean local installation of Octopress filled with content, configuration and some little customizations (style changes, some plugins added, etc.).</li>
<li>Also I have an existing GitHub Pages repository (https://github.com/bzamecnik/zamecnik.me) that contains a single static page generated by Middleman and available at http://zamecnik.me/ via CNAME. It is a Project repository, not a User/Organization one. So the sources are in the <code>master</code> branch and the HTML files for publishing in the <code>gh-pages</code> branch.</li>
<li>The deployment rake task <code>rake deploy</code> generates the output files into the <code>_deploy</code> directory, makes a new nested Git repo there and sets its <code>origin</code> remote to the provided GitHub repository URL.</li>
</ul>
<p>I'd like to deploy the local Octopress to this existing repository. The manual and the scripts, on the other hand, expect that the repository be empty. When I run <code>rake deploy</code> it tries to pull from the remote repository and it fails on some files that must be merged.</p>
<pre class="code literal-block"><span></span>## Pushing generated _deploy website
To git@github.com:bzamecnik/zamecnik.me.git
 ! [rejected]        gh-pages -&gt; gh-pages (non-fast-forward)
error: failed to push some refs to 'git@github.com:bzamecnik/zamecnik.me.git'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Integrate the remote changes (e.g.
hint: 'git pull ...') before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details.
</pre>


<p>I didn't want to delete the repository and create a new one, since I wanted a smooth transition.</p>
<h4>The solution that worked for me</h4>
<p>The rough plan was to manually merge both branches <code>master</code> and <code>gh-pages</code> and then let the deploy scripts do their usual work.</p>
<p>I ran the <code>rake setup_github_pages</code>, <code>rake generate</code> and <code>rake deploy</code> commands. And the last one failed that it is not able to pull from the <code>gh-pages</code> branch.</p>
<ul>
<li>So first I commited all my changes in the local Octopress <code>master</code> branch.</li>
<li>Then with a clean staging area I pulled from <code>origin/master</code> to <code>master</code>. This filled the project with some Middleman files that coincidently were also located in the <code>source/</code> directory.</li>
<li>In the Git client I reset and removed all those files to reverted back to the previous state.</li>
<li>Then (being in the merge mode) I commited the merge commit (which had essentially no changes) but joined my local <code>master</code> branch with <code>origin/master</code>.</li>
<li>Then I was able to push it without problems.</li>
</ul>
<p>Then I had to switch to the nested repository located at the <code>_deploy</code> directory. It contained the local <code>gh-pages</code> branch an also <code>origin/gh-pages</code> which was in a different commit tree.</p>
<ul>
<li>I had to manually delete the local <code>gh-pages</code> branch (generated by <code>rake deploy</code>) with <code>git branch -D gh-pages</code>.</li>
<li>Then I checked out the remote <code>origin/gh-pages</code> as a tracking branch with <code>git checkout -t  -b gh-pages origin/gh-pages</code>.</li>
<li>Then I ran <code>rake deploy</code> again and it worked like charm by then since local commits were now just fast-forward compared to those in the origin.</li>
</ul>
<p>And that's it!</p>
<p>Hope that it helps anyone.</p>
</div>
    </section><aside class="sharing no-print"><a href="#content" aria-label="Post beginning">
       <i class="fa fa-2x fa-fw fa-arrow-circle-up" aria-hidden="true" title="Post beginning"></i>
    </a>
    <a href="https://bohumirzamecnik.cz/blog/2013/week-of-hustle-day-6-and-7/" rel="prev" title="Week of Hustle - Day 6 and 7">
       <i class="fa fa-2x fa-fw fa-arrow-circle-left" aria-hidden="true" title="Previous post: Week of Hustle - Day 6 and 7"></i>
    </a>
    <a href="https://bohumirzamecnik.cz/blog/2014/harmoneye-for-android-released/" rel="next" title="Next post: HarmonEye for Android Released" aria-label="Next post: HarmonEye for Android Released">
       <i class="fa fa-2x fa-fw fa-arrow-circle-right" aria-hidden="true"></i>
    </a>
    <span class="post-sharing">
     <a href="http://twitter.com/share?text=Deploying+Octopress+to+existing+GitHub+Pages+repo&amp;url=https%3A%2F%2Fbohumirzamecnik.cz%2Fblog%2F2014%2Fdeploying-octopress-to-existing-github-pages-repo%2F" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" aria-label="Share on Twitter">
       <i class="fa fa-2x fa-fw fa-twitter-square" aria-hidden="true" title="Share on Twitter">
     </i></a>
     <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbohumirzamecnik.cz%2Fblog%2F2014%2Fdeploying-octopress-to-existing-github-pages-repo%2F" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" aria-label="Share on Facebook">
       <i class="fa fa-2x fa-fw fa-facebook-square" style="margin-left: -8px" aria-hidden="true" title="Share of Facebook">
     </i></a>
     <a href="https://plus.google.com/share?url=https%3A%2F%2Fbohumirzamecnik.cz%2Fblog%2F2014%2Fdeploying-octopress-to-existing-github-pages-repo%2F" aria-label="Share on Google+" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
       <i class="fa fa-2x fa-fw fa-google-plus-square" style="margin-left: -8px" aria-hidden="true" title="Share on Google+">
     </i></a>
     </span>
</aside><div itemprop="author" itemscope itemtype="http://schema.org/Person">


        <section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="bzamecnik",
            disqus_url="https://bohumirzamecnik.cz/blog/2014/deploying-octopress-to-existing-github-pages-repo/",
        disqus_title="Deploying Octopress to existing GitHub Pages repo",
        disqus_identifier="cache/posts/2014/deploying-octopress-to-existing-github-pages-repo.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script>var disqus_shortname="bzamecnik";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>
© 2020 <a href="mailto:bohumir.zamecnik@gmail.com">Bohumír Zámečník</a>
- Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>,
theme based on: <a href="https://themes.getnikola.com/v7/jidn/">jidn</a>
/ <a href="https://github.com/poole/lanyon">lanyon</a>

</p>
            
        </footer>
</div>
    </article>
</div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-44857522-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script><script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</div>
</body>
</html>
